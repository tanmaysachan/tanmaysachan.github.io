<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../styles.css">
    <meta name="google-site-verification" content="LM4GhB5Y1CsiX4EhmQygTx1arB_gKDc0wQjpK2MFTOs" />
    <meta name="description" content="A write-up by Tanmay Sachan on machine learning, systems programming, and computer science." />
    <meta name="author" content="Tanmay Sachan" />
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Tanmay Sachan's Blog" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    
    <!-- Rubik font + Caveat for handwritten style -->
    <link
      href="https://fonts.googleapis.com/css2?family=Rubik&family=Caveat:wght@500&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <script src="../loader.js"></script>

    <script src="https://kit.fontawesome.com/9016fec2c3.js" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/showdown@2.1.0/dist/showdown.min.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?autorun=false"></script>

    <link rel="apple-touch-icon" sizes="180x180" href="../assets/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="../assets/favicon_io/site.webmanifest" crossorigin="use-credentials">

    <title>A small collection</title>
  </head>
  <body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
      <div class="theme-callout">
        <span class="theme-callout-text">light / dark mode</span>
        <svg class="theme-callout-arrow" viewBox="0 0 40 32">
          <path d="M4 8 Q 12 6, 18 12 Q 24 18, 32 14 Q 36 12, 38 10" />
        </svg>
      </div>
      <button class="theme-toggle-btn" id="theme-toggle" title="Toggle theme">
        <!-- Sun Icon -->
        <svg class="theme-icon icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <!-- Moon Icon -->
        <svg class="theme-icon icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </div>

    <div class="container col-sm" id="site-header">
    </div>
    <div class="container row" id="shareable-box">
      <div class="col">
        <!-- <a id="shareable-link" href="javascript:void(0);"><i class="fa-solid fa-link"></i> Copy shareable link for this write-up</a> -->
      </div>
    </div>
    <div class="row" id="content-block">
      <div class="col-xs" id="back-button">
        <a href="../index.html"><i class="fa-solid fa-chevron-left"></i></a>
      </div>
      <div class="container float-left col" id="post-block" style="font-family: 'Rubik', sans-serif;">
          <h1 id="tinkeringwithctms">Tinkering with CTMs</h1>
<p>CTM == <a href="https://arxiv.org/abs/2505.05522" target="_blank">Continuous thought machines</a></p>
<p>This is a rather recent paper by Sakana AI, making strides towards brain-inspired neural architectures. As of late, I've enjoyed playing
around with models inspired by the "real world". They propose some really cool ideas!</p>
<p>The novelty of CTM is the introduction of time as fundamental part of model identity, and not something of an afterthought (with concepts like Time2Vec).
CTMs think in "ticks", growing confident overtime as they grok the problem statement.</p>
<p><img src="../assets/23597.gif" alt="CTM demo GIF" style="max-width: 280px; width: 100%; height: auto;" /></p>
<p>Architecturally they propose 2 new ideas -</p>
<ol>
<li>Neuron Level Models - Each "neuron" is actually a deep MLP, which takes new inputs along with a window of its past activations (as to reflect on its decisions).</li>
<li>Latent representation via synchronization - The actual representation used for solving the task is derived via synchronization of Neurons.</li>
</ol>
<p>Input data from the problem statement almost feels like an afterthought - and is introduced as queries to an attention block.</p>
<p><img src="../assets/architecture.jpeg" alt="CTM architecture" style="max-width: 400px; width: 100%; height: auto;" /></p>
<p>They go into a lot of depth in the paper about how this stuff comes together, and how they are able to induce reasoning to solve tasks such as mazes solely
as an artifact of architecture. Pretty cool!</p>
<p>It even learns how to solve mazes of size greater than it was exposed to in the training set.</p>
<p><img src="../assets/maze-solve.gif" alt="CTM maze solve demo" style="max-width: 280px; width: 100%; height: auto;" /></p>
<h2 id="neuronsconnect">Neurons, connect?</h2>
<p>I was curious as to why neurons did not have a way of passing around information. If one neuron fires, what if it was able to tell the other to fire a little harder?
This got me looking into what "muscle memory" really is.</p>
<p>Muscle Memory happens when repeated, deliberate practice enforces inter-neuronal connections. Spike-timing-dependent-plasticity (STDP) is the process
that enables it.</p>
<p>The obvious question was - can I simulate this?</p>
<p>I got to work to understand what muscle memory in maze solving might look like. Asking a couple people to solve mazes -</p>
<ol>
<li>People with lower hand-eye coordination were able to craft shorter traces towards the solutions.</li>
<li>People with better coordination (mostly video game enthusiasts) were able to take longer strides towards the solution.</li>
</ol>
<p>This got me thinking - what if a CTM with muscle memory is able to solve a maze in fewer steps than a regular CTM?</p>
<p>I had a lot of failed attempts, which I won't post about here, but I got it to work! I added a weight matrix W which held strength values - how much
does Neuron i's output affect Neuron j.</p>
<h4 id="mysolution">My solution</h4>
<p>I defined an update function for this matrix - The weight increases if Neuron i fired at a tick just before Neuron j; as simple as that.</p>
<p>Equation:</p>
<p>$W_{ij}(t+1) = decay \cdot W_{ij}(t) + \alpha \cdot a_i(t-1) \cdot a_j(t)$</p>
<p>Where W is the weight matrix, decay is a biology inspired temporal phenomenon of neuronal connectivity decaying over time, Alpha is the learning rate
and $a_i$ and $a_j$ are Neuronal activations at timestamps t-1 and t.</p>
<h4 id="buthowshouldthisweightmatrixbeutilizedbyaneuron">But how should this weight matrix be utilized by a Neuron?</h4>
<p>Equation:</p>
<p>$a'_j = a_j + gate_j \cdot \sum_i \left(a_i \cdot W_{ij}\right)$</p>
<p>A rather easy equation. I add a learnable $gate_j$ for each Neuron to either fully learn or reject all incoming signal from other neurons - this is not
learnable at a Neuron-Neuron level, but only at an overall per Neuron level - I did not want to leave the learning in backprop's hands. The idea is to make this interpretable.</p>
<p>Training this model, I was able to actually see the number of steps to solve a maze drop significantly - especially for harder mazes that required more
reasoning!</p>
<p><img src="../assets/combined_process.gif" alt="CTM combined process demo" style="max-width: 280px; width: 100%; height: auto;" /></p>
<p>GIF of a maze significantly harder than the training solution being solved by Muscle Memory induction in CTMs ^</p>
<p>Of course this analysis requires more deep diving - but this was a great weekend project. Thanks for reading!</p>
      </div>
      <div id="not-mobile" class="col">
      </div>
    </div>

    <!-- Bootstrap JS (optional) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- Theme Toggle Script -->
    <script>
      (function() {
        const THEME_KEY = 'theme-preference';
        const THEMES = ['light', 'dark'];
        const TITLES = { light: 'Light mode', dark: 'Dark mode' };

        function normalizeTheme(theme) {
          return THEMES.includes(theme) ? theme : 'light';
        }
        
        function applyTheme(theme) {
          const normalizedTheme = normalizeTheme(theme);
          document.documentElement.setAttribute('data-theme', normalizedTheme);
          
          // Update icon visibility
          document.querySelectorAll('.theme-icon').forEach(icon => icon.classList.remove('active'));
          const activeIcon = document.querySelector('.icon-' + (normalizedTheme === 'light' ? 'sun' : 'moon'));
          if (activeIcon) activeIcon.classList.add('active');
          
          // Update button title
          const btn = document.getElementById('theme-toggle');
          if (btn) btn.title = TITLES[normalizedTheme];
        }
        
        function cycleTheme() {
          const current = normalizeTheme(localStorage.getItem(THEME_KEY));
          const nextIndex = (THEMES.indexOf(current) + 1) % THEMES.length;
          const next = THEMES[nextIndex];
          localStorage.setItem(THEME_KEY, next);
          applyTheme(next);
        }
        
        // Initialize theme on page load
        const savedTheme = normalizeTheme(localStorage.getItem(THEME_KEY));
        localStorage.setItem(THEME_KEY, savedTheme);
        applyTheme(savedTheme);
        
        // Set up button click handler
        document.getElementById('theme-toggle').addEventListener('click', cycleTheme);
      })();
    </script>
  </body>
</html>
